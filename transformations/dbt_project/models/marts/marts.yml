version: 2

models:
  - name: mart_customer_analytics
    description: >
      Customer-level analytics aggregation. Provides metrics per customer
      including total spend, transaction counts, lifetime, and product diversity.
    columns:
      - name: customer_id
        description: Unique customer identifier
        tests:
          - unique
          - not_null
      - name: total_transactions
        description: Total number of transactions by this customer
      - name: total_spent
        description: Total monetary value spent by this customer
      - name: avg_transaction_value
        description: Average transaction amount for this customer
      - name: first_transaction_date
        description: Date of the customer's first transaction
      - name: last_transaction_date
        description: Date of the customer's most recent transaction
      - name: customer_lifetime_days
        description: Number of days between first and last transaction

  - name: mart_product_analytics
    description: >
      Product-level analytics aggregation. Provides metrics per product
      including units sold, revenue, and customer reach.
    columns:
      - name: product_id
        description: Unique product identifier
        tests:
          - unique
          - not_null
      - name: total_units_sold
        description: Total units of this product sold
      - name: total_revenue
        description: Total revenue generated by this product
      - name: unique_customers
        description: Number of distinct customers who purchased this product
      - name: avg_price_per_unit
        description: Average selling price per unit

  - name: mart_daily_summary
    description: >
      Daily rollup for dashboard consumption. Provides daily aggregated
      metrics including transaction counts, revenue, and unique participants.
      Uses incremental materialization for efficient processing.
    columns:
      - name: date
        description: Calendar date for the summary
        tests:
          - unique
          - not_null
      - name: total_transactions
        description: Number of transactions on this date
      - name: total_revenue
        description: Total revenue (amount * quantity) on this date
      - name: avg_transaction_value
        description: Average transaction amount on this date
      - name: unique_customers
        description: Number of distinct customers on this date
      - name: unique_products
        description: Number of distinct products sold on this date
