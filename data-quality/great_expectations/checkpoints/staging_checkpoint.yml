# Staging Layer Validation Checkpoint
# Validates data after initial transformation in the Silver layer

name: staging_checkpoint
config_version: 1.0

template_name: null
module_name: great_expectations.checkpoint
class_name: Checkpoint

run_name_template: "staging_validation_%Y%m%d_%H%M%S"

expectation_suite_name: null

action_list:
  - name: store_validation_result
    action:
      class_name: StoreValidationResultAction

  - name: store_evaluation_params
    action:
      class_name: StoreEvaluationParametersAction

  - name: update_data_docs
    action:
      class_name: UpdateDataDocsAction
      site_names:
        - local_site

  # Log validation results to PostgreSQL for reporting
  - name: log_to_postgres
    action:
      class_name: PostgresLogValidationAction
      module_name: plugins.validation_store
      postgres_conn_id: postgres_default
      schema: data_platform
      table: validation_results

evaluation_parameters: {}
runtime_configuration: {}

validations:
  # Validate staged transactions
  - batch_request:
      datasource_name: postgres_datasource
      data_connector_name: default_inferred_connector
      data_asset_name: staging.stg_transactions
    expectation_suite_name: curated/staging_transactions_suite

profilers: []
