# ==============================
# PostgreSQL
# ==============================
POSTGRES_USER=airflow
POSTGRES_PASSWORD=airflow
POSTGRES_DB=airflow
POSTGRES_PORT=5432

# ==============================
# MinIO (S3-compatible storage)
# ==============================
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=minio123
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

# ==============================
# Airflow
# ==============================
AIRFLOW_DB=airflow
AIRFLOW_FERNET_KEY=
AIRFLOW_SECRET_KEY=change-me-in-production
AIRFLOW_ADMIN_USER=admin
AIRFLOW_ADMIN_PASSWORD=admin
AIRFLOW_WEBSERVER_PORT=8080

# Airflow tuning
AIRFLOW__LOGGING__LOGGING_LEVEL=INFO              # Log verbosity: DEBUG, INFO, WARNING, ERROR
AIRFLOW__CORE__PARALLELISM=32                      # Max concurrent tasks across all DAGs
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=3           # Max concurrent runs per DAG
AIRFLOW__SCHEDULER__DAG_DIR_LIST_INTERVAL=60       # DAG directory scan interval (seconds)
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=True             # Expose config in UI (disable in production)
AIRFLOW__WEBSERVER__RBAC=True                      # Enable role-based access control

# MinIO Bucket Configuration (Medallion Architecture)
# Bronze layer: raw ingested data (immutable)
# Silver layer: cleaned and validated data
# Gold layer: business-ready aggregated data
MINIO_BRONZE_BUCKET=raw
MINIO_SILVER_BUCKET=staging
MINIO_GOLD_BUCKET=curated

# ==============================
# Superset (BI / Visualization Layer)
# ==============================
# Secret key for session encryption and CSRF protection
# IMPORTANT: Generate a unique key for production using:
#   openssl rand -base64 42
SUPERSET_SECRET_KEY=change-me-in-production

# Superset metadata database (uses PostgreSQL for persistence)
# This stores dashboards, charts, users, and Superset configuration
SUPERSET_DB=superset
SUPERSET_DATABASE_URI=postgresql+psycopg2://airflow:airflow@postgres:5432/superset

# Default admin credentials (change in production)
SUPERSET_ADMIN_USER=admin
SUPERSET_ADMIN_PASSWORD=admin
SUPERSET_ADMIN_EMAIL=admin@example.com

# Superset web UI port
SUPERSET_PORT=8088

# Additional users created during initialization:
#   - analyst / analyst123 (Analyst role: create dashboards, SQL Lab)
#   - viewer / viewer123 (Viewer role: read-only dashboard access)
# See docs/superset-guide.md for role details

# ==============================
# Great Expectations (Data Quality)
# ==============================
# PostgreSQL connection string for GE datasources and validation stores
POSTGRES_CONNECTION_STRING=postgresql+psycopg2://airflow:airflow@postgres:5432/airflow

# Path to Bronze/raw data layer for file-based validation
BRONZE_DATA_PATH=/opt/airflow/data-quality/sample_data

# MinIO/S3 connection for Data Docs publication
MINIO_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=minio
MINIO_SECRET_KEY=minio123

# Bucket for Data Docs HTML reports
DATA_DOCS_BUCKET=data-docs

# ==============================
# Alerting Configuration
# ==============================
# Enable/disable alerting channels
ALERT_EMAIL_ENABLED=false
ALERT_SLACK_ENABLED=false

# SMTP settings for email alerts
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=alerts@dataplatform.local

# Email recipients (comma-separated list)
ALERT_EMAIL_RECIPIENTS=ops@example.com,data-team@example.com

# Slack webhook configuration
SLACK_WEBHOOK_URL=
SLACK_ALERT_CHANNEL=#data-platform-alerts

# Minimum severity level to trigger alerts (CRITICAL, HIGH, MEDIUM, LOW)
ALERT_SEVERITY_THRESHOLD=MEDIUM

# SLA monitoring
SLA_MONITORING_ENABLED=true

# ==============================
# OpenMetadata (Data Catalog & Governance)
# ==============================
# OpenMetadata server configuration
OPENMETADATA_PORT=8585
OPENMETADATA_ADMIN_PORT=8586

# Elasticsearch for OpenMetadata search
ELASTICSEARCH_PORT=9200

# JWT token for API authentication (generate for production)
# Generate using: openssl rand -base64 32
OPENMETADATA_JWT_TOKEN=

# Authentication configuration
# Options: basic, ldap, saml, oidc
OPENMETADATA_AUTH_PROVIDER=basic

# For OIDC/SSO authentication (configure if using OIDC)
# OPENMETADATA_OIDC_CLIENT_ID=
# OPENMETADATA_OIDC_CLIENT_SECRET=
# OPENMETADATA_OIDC_DISCOVERY_URI=

# Ingestion configuration
# Schedule for metadata sync (cron expression)
METADATA_SYNC_SCHEDULE=0 */6 * * *

# dbt artifacts path for lineage extraction
DBT_PROJECT_PATH=/opt/airflow/transformations/dbt_project
